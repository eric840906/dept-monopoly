# 🎯 MTO 體驗營 (Team Building Board Game)

一個基於 Phaser.js 和 Socket.io 的實時多人 MTO 體驗營，專為 60-80 人的企業團隊活動設計。

## 🌟 遊戲特色

### 核心特點

- **實時多人**: 支援 60-80 人同時遊戲
- **雙屏體驗**: 投影機主畫面 + 手機操作介面
- **智能分組**: 自動將玩家分配到 5-8 個團隊
- **豐富小遊戲**: 5 種不同類型的團隊挑戰
- **即時計分**: 實時積分系統和排行榜
- **主持人控制**: 完整的遊戲管理功能

### 遊戲機制

- **棋盤**: 28 格環形棋盤，包含事件格和安全格
- **回合制**: 每隊 90 秒時間限制
- **積分系統**: 起始 100 分，根據小遊戲表現獲得/失去積分
- **能力系統**: 每隊擁有 6 種能力屬性（技術、創意、溝通、危機、營運、運氣）
- **遊戲時長**: 20-30 分鐘，15-20 回合

## 🛠️ 技術架構

### 後端技術

- **Node.js** + **Express**: 伺服器框架
- **Socket.io**: 實時通訊
- **CORS**: 跨域支援

### 前端技術

- **Phaser.js 3.70**: 主畫面遊戲引擎
- **原生 JavaScript**: 手機介面
- **響應式 CSS**: 適配各種螢幕尺寸
- **Socket.io Client**: 即時連線

### 檔案結構

```
dept-monopoly/
├── server/                 # 後端程式
│   ├── index.js           # 主伺服器檔案
│   ├── game/              # 遊戲邏輯
│   │   ├── GameManager.js # 遊戲狀態管理
│   │   └── MiniGames.js   # 小遊戲處理器
│   └── socket/            # WebSocket 處理
│       └── handlers.js    # 事件處理器
├── client/                # 前端程式
│   ├── main/              # 主畫面 (投影機)
│   │   ├── index.html     # 主頁面
│   │   ├── js/main.js     # 主應用邏輯
│   │   ├── scenes/        # Phaser 場景
│   │   └── ui/            # UI 組件
│   └── mobile/            # 手機介面
│       ├── index.html     # 手機頁面
│       ├── js/mobile.js   # 手機應用邏輯
│       ├── styles/        # CSS 樣式
│       └── components/    # UI 組件
├── shared/                # 共用程式
│   ├── types.js          # 資料結構定義
│   └── constants.js      # 遊戲常數
└── package.json          # 專案配置
```

## 🚀 快速開始

### 環境需求

- **Node.js** 16+
- **npm** 8+
- **現代瀏覽器** (Chrome, Safari, Firefox)

### 安裝步驟

1. **克隆專案**

```bash
git clone <repository-url>
cd dept-monopoly
```

2. **安裝依賴**

```bash
npm install
```

3. **啟動伺服器**

```bash
npm start
```

4. **開啟遊戲**

- 主畫面 (投影機): http://localhost:3000
- 手機介面: http://localhost:3000/mobile
- 主持人模式: http://localhost:3000?host=true

### 開發模式

```bash
npm run dev  # 使用 nodemon 自動重啟
```

## 🎮 遊戲操作指南

### 主持人操作

#### 基本控制

1. **分配隊伍**: 將玩家自動分組為 5-8 個團隊
2. **開始遊戲**: 啟動遊戲並開始第一回合
3. **跳過回合**: 強制結束當前回合
4. **結束遊戲**: 立即結算並顯示最終結果

#### 進階控制

- **遊戲設定**: 調整回合時間、最大回合數
- **隊伍管理**: 移動隊伍位置、淘汰/復活隊伍
- **積分調整**: 手動調整隊伍積分
- **遊戲狀態**: 暫停/繼續/重置遊戲
- **統計資訊**: 查看即時遊戲數據

### 玩家操作

#### 加入遊戲

1. 用手機開啟 http://localhost:3000/mobile
2. 輸入暱稱和部門
3. 等待主持人分配隊伍和開始遊戲

#### 遊戲進行

1. **等待回合**: 查看當前隊伍狀態和積分
2. **擲骰子**: 輪到自己隊伍時點擊擲骰
3. **完成小遊戲**: 根據落地格子參與相應挑戰
4. **查看結果**: 即時查看積分變化和排名

## 🎯 小遊戲類型

### 1. 選擇題挑戰 (30 秒)

- **內容**: 企業文化、團隊合作相關問題
- **玩法**: 多數決選擇答案
- **計分**: 正確 +10 分，錯誤 -10 分

### 2. 流程排序 (45 秒)

- **內容**: 專案管理、產品開發等工作流程
- **玩法**: 拖拽排列正確順序
- **計分**: 完全正確 +10 分，部分正確 +5 分，錯誤 -10 分

### 3. 連連看 (45 秒)

- **內容**: 技術與應用、部門與職責等配對
- **玩法**: 連接左右兩列對應項目
- **計分**: 80%以上正確 +10 分，50%以上 +5 分，其他 -10 分

### 4. 團隊協作 (60 秒)

- **內容**: 共同決策、價值觀排序等
- **玩法**: 隊伍成員共同討論並決定
- **計分**: 根據參與度給分，基本 +5 到 +10 分

### 5. 隨機事件 (15 秒)

- **內容**: 基於隊伍能力值的骰子檢定
- **玩法**: 擲骰子 + 能力加成，可使用重擲
- **計分**: 成功 +10 分，失敗 -10 分

## 📊 積分規則

### 基本積分

- **起始積分**: 每隊 100 分
- **成功獎勵**: +10 分
- **部分成功**: +5 分
- **失敗懲罰**: -10 分
- **參與獎勵**: +5 分 (團隊協作)

### 能力系統

每隊擁有 6 種能力，數值 1-6：

- **技術 (Tech)**: 處理技術問題
- **創意 (Creative)**: 創新解決方案
- **溝通 (Comms)**: 協調合作
- **危機 (Crisis)**: 應急處理
- **營運 (Ops)**: 流程優化
- **運氣 (Luck)**: 隨機事件加成

### 特殊機制

- **重擲次數**: 每隊 3 次，用於隨機事件
- **時間加成**: 快速完成可獲得額外分數
- **連勝獎勵**: 連續成功有機會獲得加成

## 🔧 配置選項

### 遊戲參數 (shared/constants.js)

```javascript
const GAME_CONFIG = {
  MAX_PLAYERS: 80, // 最大玩家數
  MIN_TEAMS: 5, // 最少隊伍數
  MAX_TEAMS: 8, // 最多隊伍數
  TURN_TIME_LIMIT: 90000, // 回合時間限制 (毫秒)
  GAME_DURATION: 1800000, // 遊戲總時長 (毫秒)
  BOARD_SIZE: 28, // 棋盤格數
}
```

### 計分設定

```javascript
SCORING: {
  SUCCESS: 10,     // 成功分數
  PARTIAL: 5,      // 部分成功分數
  FAILURE: -10,    // 失敗分數
  STARTING_SCORE: 100  // 起始分數
}
```

### 小遊戲時間限制

```javascript
MINI_GAME_TIME_LIMITS: {
  MULTIPLE_CHOICE: 30000,  // 選擇題
  DRAG_DROP: 45000,        // 拖拽排序
  FORMAT_MATCHING: 45000,  // 格式配對
  TEAM_PAIRING: 60000,     // 團隊協作
  RANDOM_EVENT: 15000      // 隨機事件
}
```

## 🌐 部署指南

### 本地部署

```bash
# 開發環境
npm run dev

# 生產環境
npm start
```

### 內網部署

1. 確保伺服器可以被內網所有裝置訪問
2. 修改防火牆設定允許 3000 連接埠
3. 更新手機介面的連接 URL

### 雲端部署

支援部署到以下平台：

- **Heroku**: 添加 Procfile
- **AWS**: 使用 EC2 或 Elastic Beanstalk
- **Google Cloud**: 使用 App Engine
- **Azure**: 使用 Web Apps

### 環境變數

```bash
PORT=3000                    # 伺服器連接埠
NODE_ENV=production         # 環境模式
MAX_PLAYERS=80              # 最大玩家數 (可選)
GAME_DURATION=1800000       # 遊戲時長 (可選)
```

## 🔍 故障排除

### 常見問題

#### 1. 連接問題

**症狀**: 手機無法連接到伺服器
**解決方案**:

- 確認伺服器正在運行
- 檢查防火牆設定
- 確保在同一網路環境

#### 2. 遊戲卡頓

**症狀**: 遊戲進行中出現延遲或卡住
**解決方案**:

- 檢查網路連接穩定性
- 重新整理瀏覽器頁面
- 主持人可使用「跳過回合」功能

#### 3. 分數異常

**症狀**: 積分計算錯誤或未更新
**解決方案**:

- 主持人可手動調整積分
- 檢查瀏覽器開發者工具的錯誤訊息
- 重啟遊戲服務

#### 4. 小遊戲無法載入

**症狀**: 點擊後小遊戲沒有出現
**解決方案**:

- 檢查網路連接
- 重新整理頁面
- 確認瀏覽器支援 JavaScript

### 除錯工具

```bash
# 查看伺服器日誌
npm start

# 瀏覽器開發者工具
F12 -> Console -> 查看錯誤訊息

# 網路連接測試
ping <server-ip>
```

## 🎨 自訂指南

### 修改遊戲內容

#### 1. 新增小遊戲題目

編輯 `server/game/MiniGames.js`:

```javascript
// 新增選擇題
const questions = [
  {
    question: '你的問題',
    options: ['選項A', '選項B', '選項C', '選項D'],
    correct: 0, // 正確答案索引
    explanation: '解釋',
  },
]
```

#### 2. 調整棋盤大小

修改 `shared/constants.js`:

```javascript
const GAME_CONFIG = {
  BOARD_SIZE: 32, // 改變棋盤格數
  // ...
}
```

#### 3. 更改團隊顏色

修改 `shared/constants.js`:

```javascript
const TEAM_COLORS = [
  '#FF6B6B', // 新增更多顏色
  '#4ECDC4',
  // ...
]
```

### 樣式自訂

#### 1. 主畫面樣式

編輯 `client/main/index.html` 中的 CSS

#### 2. 手機介面樣式

編輯 `client/mobile/styles/mobile.css`

#### 3. 品牌化

- 替換 Logo 和圖示
- 修改色彩主題
- 更新文字內容

## 📈 效能最佳化

### 伺服器效能

- 使用 PM2 進行程序管理
- 啟用 gzip 壓縮
- 實施連接限制
- 監控記憶體使用量

### 前端效能

- 壓縮圖片資源
- 最小化 CSS/JS 檔案
- 使用 CDN 託管靜態資源
- 實施快取策略

### 網路優化

- 使用有線連接提供伺服器
- 確保足夠的頻寬
- 設置 QoS 優先級
- 監控網路延遲

## 🤝 貢獻指南

### 開發環境設置

1. Fork 專案
2. 創建功能分支
3. 安裝開發依賴
4. 遵循程式碼風格指南

### 提交代碼

1. 確保所有測試通過
2. 更新相關文檔
3. 創建 Pull Request
4. 等待代碼審查

### 報告問題

- 使用 GitHub Issues
- 提供詳細的重現步驟
- 包含環境資訊
- 附上螢幕截圖 (如適用)

## 📄 授權條款

本專案採用 MIT 授權條款 - 詳見 [LICENSE](LICENSE) 檔案

## 👥 聯絡資訊

- **專案維護者**: [Your Name]
- **Email**: [your.email@example.com]
- **專案首頁**: [GitHub Repository URL]

## 🎉 致謝

感謝以下技術和專案：

- [Phaser.js](https://phaser.io/) - 優秀的 HTML5 遊戲框架
- [Socket.io](https://socket.io/) - 實時通訊解決方案
- [Express.js](https://expressjs.com/) - 快速、簡潔的 Web 框架
- [Node.js](https://nodejs.org/) - JavaScript 運行環境

---

🎯 **享受團隊建設的樂趣！** 🎯
